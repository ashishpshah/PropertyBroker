@using Broker.Infra
@model ResponseModel<LoginViewModel>
@{
	ViewData["Title"] = "Home Page";
}

@section Styles {
	<style type="text/css">
		.error {
			display: block !important;
		}

		.form-label {
			margin-bottom: 0 !important;
		}

		.form-control {
			font-size: 16px;
			line-height: 26px;
			background-color: #fff;
			border: 0;
			border-bottom: 1px solid #e7e7e7;
			border-radius: 0;
			font-weight: bold;
			margin-bottom: 7px;
		}

		.shadow {
			box-shadow: var(--bs-box-shadow) !important;
		}

		.nav-pills .nav-link.active {
			border-bottom: 3px solid #38bdf8 !important;
			border-radius: 0 !important;
			background: transparent !important;
			color: #38bdf8 !important;
		}

		.choices__inner {
			padding: 13px 6px 15px 15px !important;
		}

		.btn-outline-primary:hover, .btn-outline-primary:focus, .btn-outline-primary:active {
			background-color: #38bdf8 !important;
			border-color: #38bdf8 !important;
			color: #fff !important;
			box-shadow: 0 3px 5px 0 rgba(56, 189, 248, 0.1);
		}

	</style>
}

<section class="position-relative mt-5 pt-4">
	<div class="container-fluid px-0 mt-2">
		<div class="bg-home-one d-table w-100 shadow overflow-hidden" id="home">
			<div class="bg-overlay image-wrap" id="hero-images"></div>
			<div class="bg-overlay bg-black opacity-50"></div>

			<div class="container">
				<div class="row justify-content-center">
					<div class="col-12">
						<div class="title-heading">
							<h4 class="heading fw-bold text-white title-dark mb-3">We will help you find <br> your <span class="typewrite text-primary" data-period="2000" data-type='[ "Wonderful", "Dream" ]'></span> home</h4>
							<p class="para-desc text-white title-dark mb-0">A reliable marketplace for buying, and renting properties with our support.</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<section class="section pt-5">
	<div class="container">
		<div class="row justify-content-center">
			<div class="col-12 mt-sm-0 pt-sm-0">
				<div class="features-absolute">
					<ul class="nav nav-pills bg-white border-bottom p-3 flex-row d-md-inline-flex mb-0 rounded-top-3 position-relative overflow-hidden" id="pills-tab" role="tablist">

						@if (Model.SelectListItems != null)
						{
							var category = Model.SelectListItems.Where(x => x.Group == "PC").OrderBy(x => x.OrderBy == null || x.OrderBy == 0).ThenBy(x => x.OrderBy).ToList();

							for (int i = 0; i < category.Count(); i++)
							{
								<li class="nav-item m-1 shadow">
									<a class="nav-link py-2 px-4 @(i == 0 ? "active" : "") rounded-3 fw-medium" id="@category[i].Value" data-bs-toggle="pill" href="#" role="tab" aria-controls="@category[i].Value" aria-selected="false">
										@category[i].Text
									</a>
								</li>
							}
						}
					</ul>

					<div class="bg-white rounded-bottom-3 rounded-end-3 sm-rounded-0">
						<div class="card border-0 bg-transparent">
							<form class="card-body text-start shadow" style="border-radius: 26px; box-shadow: 0 3px 12px -9px rgba(0, 0, 0, 0.4); border: solid 1px #38bdf8; background-color: #ffffff;">
								<div class="registration-form text-dark text-start">
									<div class="row g-lg-0">
										<div class="col-lg-6 col-md-6 col-12">
											<div class="mb-3 text-start">
												<div class="filter-search-form position-relative filter-border">
													<select class="form-select choices-select" id="choices-PropertyLocation" data-placeholder="Select Location">
														@if (Model.SelectListItems != null)
														{
															foreach (var item in Model.SelectListItems.Where(x => x.Group == "L"))
															{
																<option value="@item.Value">@item.Text</option>
															}
														}
													</select>
												</div>
											</div>
										</div>
										@* 
										<div class="col-lg-4 col-md-6 col-12">
											<div class="mb-3 text-start">
												<div class="filter-search-form position-relative filter-border">
													<select class="form-select choices-select" id="choices-PropertyType_Parent">
														<option value="0">Select Type</option>
														@if (Model.SelectListItems != null)
														{
															foreach (var item in Model.SelectListItems.Where(x => x.Group == "PT" && int.TryParse(x.Value2, out var z) && z <= 0))
															{
																<option value="@item.Value">@item.Text</option>
															}
														}
													</select>
												</div>
											</div>
										</div>
 *@
										<div class="col-lg-3 col-md-6 col-12">
											<div class="mb-3 text-start">
												<div class="filter-search-form position-relative">
													<select class="form-select choices-select" id="choices-PropertyType" data-placeholder="Select Property Type"></select>
												</div>
											</div>
										</div>

										<div class="col-lg-3 col-md-6 col-12 align-self-end justify-content-center">
											<div class="mb-3 text-start mx-3">
												<div class="filter-search-form position-relative">
													<button type="button" class="btn btn-primary w-100" data-bs-toggle="modal" data-bs-target="#exampleModalCenteredScrollable"
															style="height: 60px; font-size: 20px; font-weight: 600;">
														Search
													</button>
												</div>
											</div>
										</div>

									</div>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="container mt-100 mt-60">
		<div class="row align-items-center">
			<div class="col-lg-6 col-md-6">
				<div class="row g-3 align-items-center">
					<div class="col-lg-7 col-6">
						<img src="~/images/hero.jpg" class="img-fluid rounded-3" alt="work-image">
					</div>

					<div class="col-lg-5 col-6">
						<div class="row g-3">
							<div class="col-lg-12 col-md-12">
								<img src="~/images/1.jpg" class="img-fluid rounded-3" alt="work-image">
							</div>

							<div class="col-lg-12 col-md-12">
								<img src="~/images/logo-icon.png" class="img-fluid" alt="work-image">
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="col-lg-6 col-md-6 mt-4 mt-sm-0 pt-2 pt-sm-0">
				<div class="section-title ms-lg-5">
					<h6 class="text-primary fw-medium mb-2">Our story: Broker</h6>
					<h4 class="title mb-3">Efficiency. <br> Transparency. Control.</h4>
					<p class="text-muted para-desc mb-0">
						Broker developed a platform for the Real Estate marketplace that allows buyers and sellers to easily execute a transaction on their own.
						<br /> The platform drives efficiency, cost transparency and control into the hands of the consumers. Towntor is Real Estate Redefined.
					</p>

				</div>
			</div>
		</div>
	</div>

	<div class="container mt-100 mt-60">
		<div class="row justify-content-center">
			<div class="col">
				<div class="section-title mb-4 pb-2">
					<h4 class="title mb-3">Listing Categories</h4>
				</div>
			</div>
		</div>
		<div class="row row-cols-lg-5 row-cols-md-3 row-cols-sm-2 row-cols-1 g-4 mt-0">
			@if (Model.Data1 != null)
			{
				foreach (PropertyType item in ((Model.Data1 as IList<PropertyType>)?.OrderBy(x => x.Display_Seq_No).ToList()))
				{
					<div class="col property-type position-relative" role="button" id="itemProperty_@item.Id" onclick="openPropertyModal(@item.Id, 0, 0)">
						<div class="categories position-relative overflow-hidden rounded-3 shadow">
							@if (!string.IsNullOrEmpty(item.ImagePath))
							{
								<img src="@Url.Content("~/" + item.ImagePath)" class="img-fluid" alt="" style="width:204px; height:140px">
							}
							else
							{
								<img src="~/no_image_available.png" class="img-fluid" alt="" style="width:204px; height:140px">
							}

							<div class="p-3">
								<span class="title text-dark fs-5 fw-medium">@item.Name</span>
								<p class="text-muted small mb-0">@item.PropertyCount @(item.PropertyCount > 1 ? "Properties" : "Property")</p>
							</div>

						</div>
					</div>
				}
			}

		</div>
	</div>

	<div class="container mt-100 mt-60">
		<div class="row justify-content-center">
			<div class="col">
				<div class="section-title mb-4 pb-2">
					<h4 class="title mb-3">Find Properies in Ahmedabad</h4>
				</div>
			</div>
		</div>
		<div class="row g-4">
			<div class="col-12">
				<ul class="nav nav-pills nav-justified bg-white rounded-3 shadow p-3 mb-0 sticky-bar" id="pills-tab" role="tablist">
					@if (Model.SelectListItems != null)
					{
						var zones = Model.SelectListItems.Where(x => x.Group == "ZONE").ToList();

						for (int i = 0; i < zones.Count(); i++)
						{
							var zone = zones[i];

							<li class="nav-item">
								<a class="nav-link rounded-3 @(i == 0 ? "show active" : "")" id="@(zone.Text)-space" data-bs-toggle="pill" href="#pills-@(zone.Text)" role="tab" aria-controls="pills-@(zone.Text)" aria-selected="false">
									<div class="text-center pt-1 pb-1">
										<h6 class="title fw-normal mb-0">Ahmedabad @(zone.Text)</h6>
									</div>
								</a>
							</li>
						}
					}

				</ul>
			</div>
		</div>
		<div class="row g-4 mt-2">
			<div class="col-12">
				<div class="tab-content" id="pills-tabContent">
					@if (Model.SelectListItems != null)
					{
						var zones = Model.SelectListItems.Where(x => x.Group == "ZONE").ToList();

						for (int i = 0; i < zones.Count(); i++)
						{
							var zone = zones[i];

							<div class="tab-pane fade bg-white @(i == 0 ? "show active" : "")" id="pills-@(zone.Text)" role="tabpanel" aria-labelledby="@(zone.Text)-space">

								<div class="row">
									<div class="col-12">
										<div class="tiny-slide-three" id="slide-@(zone.Text)">
											@{
												var areas = zone.Value2.Split(",");

												for (int j = 0; j < areas.Count(); j++)
												{
													var id = areas[j].Split("|")[0];
													var area = areas[j].Split("|")[1];

													<div class="tiny-slide">
														<div class="card property border-0 shadow position-relative overflow-hidden rounded-3 m-3">
															<div class="property-image position-relative overflow-hidden shadow">
																<img src="~/images/property/@(j + 1).jpg" class="img-fluid" alt="">
															</div>
															<div class="card-body content p-4">
																<a href="javascript:void(0)" role="button" id="itemArea_@id"
																   onclick="openPropertyModal(0, @id, 0)" class="title fs-5 text-dark fw-medium">
																	@area
																</a>
															</div>
														</div>
													</div>
												}

											}
										</div>
									</div>
								</div>
							</div>
						}
					}

				</div>
			</div>
		</div>
	</div>

	<div class="container mt-100 mt-60">
		<div class="row g-4 mt-0">

			<div class="col-lg-3 col-md-6 col-12">
				<div class="card property border-0 shadow position-relative overflow-hidden rounded-3" onclick="openPropertyModal(0, 0, 1)">
					<div class="property-image position-relative overflow-hidden shadow">
						<img src="~/images/property/1.jpg" class="img-fluid" alt="">
					</div>
					<div class="card-body content p-4">
						<a href="javascript:void(0)" class="title fs-5 text-dark fw-medium">1 BHK</a>

						<ul class="list-unstyled mt-3 py-3 border-top border-bottom d-flex align-items-center justify-content-between">
							<li class="d-flex align-items-center me-3">
								<i class="mdi mdi-arrow-expand-all fs-5 me-2 text-primary"></i>
								<span class="text-muted">8000sqf</span>
							</li>

							<li class="d-flex align-items-center me-3">
								<i class="mdi mdi-bed fs-5 me-2 text-primary"></i>
								<span class="text-muted">4 Beds</span>
							</li>

							<li class="d-flex align-items-center">
								<i class="mdi mdi-shower fs-5 me-2 text-primary"></i>
								<span class="text-muted">4 Baths</span>
							</li>
						</ul>
						
					</div>
				</div>
			</div>

			<div class="col-lg-3 col-md-6 col-12">
				<div class="card property border-0 shadow position-relative overflow-hidden rounded-3" onclick="openPropertyModal(0, 0, 2)">
					<div class="property-image position-relative overflow-hidden shadow">
						<img src="~/images/property/1.jpg" class="img-fluid" alt="">
					</div>
					<div class="card-body content p-4">
						<a href="javascript:void(0)" class="title fs-5 text-dark fw-medium">2 BHK</a>

						<ul class="list-unstyled mt-3 py-3 border-top border-bottom d-flex align-items-center justify-content-between">
							<li class="d-flex align-items-center me-3">
								<i class="mdi mdi-arrow-expand-all fs-5 me-2 text-primary"></i>
								<span class="text-muted">8000sqf</span>
							</li>

							<li class="d-flex align-items-center me-3">
								<i class="mdi mdi-bed fs-5 me-2 text-primary"></i>
								<span class="text-muted">4 Beds</span>
							</li>

							<li class="d-flex align-items-center">
								<i class="mdi mdi-shower fs-5 me-2 text-primary"></i>
								<span class="text-muted">4 Baths</span>
							</li>
						</ul>
						
					</div>
				</div>
			</div>

			<div class="col-lg-3 col-md-6 col-12">
				<div class="card property border-0 shadow position-relative overflow-hidden rounded-3" onclick="openPropertyModal(0, 0, 3)">
					<div class="property-image position-relative overflow-hidden shadow">
						<img src="~/images/property/1.jpg" class="img-fluid" alt="">
					</div>
					<div class="card-body content p-4">
						<a href="javascript:void(0)" class="title fs-5 text-dark fw-medium">3 BHK</a>

						<ul class="list-unstyled mt-3 py-3 border-top border-bottom d-flex align-items-center justify-content-between">
							<li class="d-flex align-items-center me-3">
								<i class="mdi mdi-arrow-expand-all fs-5 me-2 text-primary"></i>
								<span class="text-muted">8000sqf</span>
							</li>

							<li class="d-flex align-items-center me-3">
								<i class="mdi mdi-bed fs-5 me-2 text-primary"></i>
								<span class="text-muted">4 Beds</span>
							</li>

							<li class="d-flex align-items-center">
								<i class="mdi mdi-shower fs-5 me-2 text-primary"></i>
								<span class="text-muted">4 Baths</span>
							</li>
						</ul>
						
					</div>
				</div>
			</div>

			<div class="col-lg-3 col-md-6 col-12">
				<div class="card property border-0 shadow position-relative overflow-hidden rounded-3" onclick="openPropertyModal(0, 0, 4)">
					<div class="property-image position-relative overflow-hidden shadow">
						<img src="~/images/property/1.jpg" class="img-fluid" alt="">
					</div>
					<div class="card-body content p-4">
						<a href="javascript:void(0)" class="title fs-5 text-dark fw-medium">4 BHK</a>

						<ul class="list-unstyled mt-3 py-3 border-top border-bottom d-flex align-items-center justify-content-between">
							<li class="d-flex align-items-center me-3">
								<i class="mdi mdi-arrow-expand-all fs-5 me-2 text-primary"></i>
								<span class="text-muted">8000sqf</span>
							</li>

							<li class="d-flex align-items-center me-3">
								<i class="mdi mdi-bed fs-5 me-2 text-primary"></i>
								<span class="text-muted">4 Beds</span>
							</li>

							<li class="d-flex align-items-center">
								<i class="mdi mdi-shower fs-5 me-2 text-primary"></i>
								<span class="text-muted">4 Baths</span>
							</li>
						</ul>
						
					</div>
				</div>
			</div>

		</div>

	</div>

	<div class="container mt-100 mt-60">
		<div class="row justify-content-center">
			<div class="col">
				<div class="section-title text-center mb-4 pb-2">
					<h4 class="title mb-3">How It Works</h4>
					<p class="text-muted para-desc mb-0 mx-auto">A simple platform that makes buying and renting properties easy, with expert help and a smooth experience from start to finish.</p>
				</div>
			</div>
		</div>

		<div class="row g-4 mt-0">
			<div class="col-md-4">
				<div class="position-relative features text-center mx-lg-4 px-md-1">
					<div class="feature-icon position-relative overflow-hidden d-flex justify-content-center">
						<i data-feather="hexagon" class="hexagon"></i>
						<div class="position-absolute top-50 start-50 translate-middle">
							<i data-feather="home" class="fea icon-m-md text-primary"></i>
						</div>
					</div>

					<div class="mt-4">
						<a href="" class="fw-medium title text-dark fs-5">Check Property</a>
						<p class="text-muted mt-3 mb-0">Take your time to explore property details and location so you can feel confident about your choice.</p>
					</div>
				</div>
			</div>

			<div class="col-md-4">
				<div class="position-relative features text-center mx-lg-4 px-md-1">
					<div class="feature-icon position-relative overflow-hidden d-flex justify-content-center">
						<i data-feather="hexagon" class="hexagon"></i>
						<div class="position-absolute top-50 start-50 translate-middle">
							<i data-feather="briefcase" class="fea icon-m-md text-primary"></i>
						</div>
					</div>

					<div class="mt-4">
						<a href="" class="fw-medium title text-dark fs-5">Talk to Agent</a>
						<p class="text-muted mt-3 mb-0">Connect with a friendly, experienced agent who can answer your questions and guide you through the process.</p>
					</div>
				</div>
			</div>

			<div class="col-md-4">
				<div class="position-relative features text-center mx-lg-4 px-md-1">
					<div class="feature-icon position-relative overflow-hidden d-flex justify-content-center">
						<i data-feather="hexagon" class="hexagon"></i>
						<div class="position-absolute top-50 start-50 translate-middle">
							<i data-feather="key" class="fea icon-m-md text-primary"></i>
						</div>
					</div>

					<div class="mt-4">
						<a href="" class="fw-medium title text-dark fs-5">Finalize Deal</a>
						<p class="text-muted mt-3 mb-0">Complete the paperwork, confirm the details, and move forward knowing everything is handled smoothly and securely.</p>
					</div>
				</div>
			</div>
		</div>
	</div>

</section>

<div class="modal fade" id="exampleModalCenteredScrollable" tabindex="-1" aria-labelledby="exampleModalCenteredScrollableTitle" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
		<div class="modal-content">
			<div class="modal-header">
				<h1 class="modal-title fs-5" id="exampleModalCenteredScrollableTitle">Please fill out your basic details in this form</h1>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" tabindex="-1"></button>
			</div>
			<div class="modal-body">
				<form id="formUserData" action="@Url.Action("Search", "Home", new { area = "" })" class="needs-validation" novalidate="">
					<div class="row g-3">
						<div class="col-sm-12">
							<div class="action justify-content-start">
								@if (Model.SelectListItems != null)
								{
									var category = Model.SelectListItems.Where(x => x.Group == "PC").OrderBy(x => x.OrderBy == null || x.OrderBy == 0).ThenBy(x => x.OrderBy).ToList();

									for (int i = 0; i < category.Count(); i++)
									{
										<div class="form-check-inline radio-style mb-20">
											<input type="radio" class="btn-check" name="flexRadioDefault" id="radio-@category[i].Value" value="@category[i].Value" autocomplete="off">
											<label class="btn btn-outline-primary" for="radio-@category[i].Value">
												@category[i].Text
											</label>
										</div>
									}
								}
							</div>
						</div>
					</div>
					<div class="row g-3 mt-3">
						<div class="col-sm-6">
							<label for="firstName" class="form-label">First name</label>
							<input type="text" class="form-control" name="FirstName" id="firstName" data-required data-msg="Please enter First name" tabindex="1">
						</div>
						<div class="col-sm-6">
							<label for="lastName" class="form-label">Last name</label>
							<input type="text" class="form-control" name="LastName" id="lastName" data-required data-msg="Please enter Last name" tabindex="2">
						</div>
						<div class="col-12">
							<label for="email" class="form-label">Email <span class="text-body-secondary">(Optional)</span></label>
							<input type="email" class="form-control" name="Email" id="email" placeholder="you@example.com" data-required data-msg="Please enter Email" tabindex="3">
						</div>
						<div class="col-12">
							<label for="ContactNo" class="form-label">Contact No.</label>
							<input type="text" class="form-control isNumberKey" name="ContactNo" id="ContactNo" maxlength="11" data-required data-msg="Please enter Contact No." tabindex="4">
						</div>
					</div>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" onclick="fnSubmitFormHere('formUserData')" tabindex="5">Submit</button>
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal" tabindex="6">Close</button>
			</div>
		</div>
	</div>
</div>


@section Scripts {
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
	<script type="text/javascript">

			easy_background("#hero-images",
				{
					slide: ["/images/bg/01.jpg", "/images/bg/02.jpg", "/images/bg/03.jpg", "/images/bg/04.jpg", "/images/bg/05.jpg"],
					delay: [10000, 10000, 10000]
				}
			);


		$(document).ready(function () {
			$('#pills-tab .nav-link.active').trigger('click');

			var sliders = document.getElementsByClassName('tiny-slide-three');

			for (var i = 0; i < sliders.length; i++) {

			// Make sure element has an ID
			if (!sliders[i].id) continue;

			tns({
				container: '#' + sliders[i].id,
					controls: true,
					mouseDrag: true,
					loop: true,
					rewind: true,
					autoplay: true,
					autoplayButtonOutput: false,
					autoplayTimeout: 3000,
					navPosition: "bottom",
					controlsText: ['<i class="mdi mdi-chevron-left "></i>', '<i class="mdi mdi-chevron-right"></i>'],
					nav: false,
					speed: 400,
					gutter: 0,
					responsive: {
						1025: {
							items: 3
						},

						992: {
							items: 2
						},

						767: {
							items: 2
						},

						320: {
							items: 1
						},
					},
				});
			}
		});

		document.querySelectorAll('.choices-select:not([data-choices-init])').forEach(el => {
			const instance = new Choices(el, { searchEnabled: true, removeItemButton: true, placeholder: true, placeholderValue: el.getAttribute('data-placeholder') || 'Select an option', });
			el._choicesInstance = instance;
			el.setAttribute('data-choices-init', 'true');
		 });

		const modalEl = document.getElementById('exampleModalCenteredScrollable');

		modalEl.addEventListener('show.bs.modal', function (event) {

			if (event.relatedTarget) {
				modalEl.dataset.openSource = event.relatedTarget.dataset.openSource || 'search-button';


				var category = $('#pills-tab .nav-link.active').attr('id');
				if (!category) category = "1";
				$('input[type="radio"][id="radio-'+category+'"]').prop("checked", true);

			}
		});


		$(document).on('click',function (e) {
			if ($(e.target).closest('.property-type').length > 0) { return; }

			$('div[id^="collapseWidthExample_"]').each(function () {
				$(this).removeClass('position-absolute');
				$(this).removeClass('d-block');
			});
		});


		function openPropertyCollapse(el) {

			$('div[id^="collapseWidthExample_"]').each(function () {
				$(this).removeClass('position-absolute');
				$(this).removeClass('d-block');
			});

			$(el).find('.collapse').addClass('position-absolute');
			$(el).find('.collapse').addClass('d-block');

		}


		function openPropertyModal(TypeId, Location, SubTypeId) {
		//function openPropertyModal(ParentTypeId, TypeId) {
			const modalEl = document.getElementById('exampleModalCenteredScrollable');

			modalEl.dataset.openSource = 'property-type';
			//modalEl.dataset.parentTypeId = ParentTypeId;
			modalEl.dataset.typeId = TypeId;
			modalEl.dataset.location = Location;
			modalEl.dataset.subtypeId = SubTypeId;

			var category = $('#pills-tab .nav-link.active').attr('id');
			if (!category) category = "1";
			$('input[type="radio"][id="radio-'+category+'"]').prop("checked", true);

			const modal = new bootstrap.Modal(modalEl);
			modal.show();
		}

		// function openPropertyModal(el) {
		// 	const modalEl = document.getElementById('exampleModalCenteredScrollable');

		// 	modalEl.dataset.openSource = 'property-type';
		// 	modalEl.dataset.propertyTypeId = el.dataset.propertyTypeId;

		// 	const modal = new bootstrap.Modal(modalEl);
		// 	modal.show();
		// }


		function fnSubmitFormHere(formId) {

			const $form = $('#' + formId);
			const modalEl = document.getElementById('exampleModalCenteredScrollable');
			const source = modalEl.dataset.openSource;

			// ---- VALIDATE USER FORM (always required) ----
			$form.validate({
				rules: {
					FirstName: { required: true },
					LastName: { required: true },
					Email: { required: true },
					ContactNo: { required: true }
				}
			});

			if (!$form.valid()) return;

			// ---- COMMON VALUES ----
			let location = '';
			let category = '';
			let typeParent = '';
			let type = '';
			let subtype = '';

			// ---- DIFFERENCE BASED ON SOURCE ----
			if (source === 'property-type') {
				// ✅ Type already selected
				//typeParent = modalEl.dataset.parentTypeId;
				type = modalEl.dataset.typeId;
				location = modalEl.dataset.location;
				subtype = modalEl.dataset.subtypeId;
			} else {
				// ✅ Search button flow → validate selects
				//typeParent = $('#choices-PropertyType_Parent').val();
				type = $('#choices-PropertyType').val();

				location = $('#choices-PropertyLocation').val();
				//category = $('#pills-tab .nav-link.active').attr('id');
			}

				category = $('input[name="flexRadioDefault"]:checked').val();

				if (!location || !category || !type) {
					showToast('Please select all search filters', 'danger', 5000);
					return;
				}

			// ---- BUILD URL ----
			const query = $form.serialize();

			// const url =
			// 	`@Url.Action("Properties", "Home")?${query}` +
			// 	`&Location=${encodeURIComponent(location)}` +
			// 	`&PropertyCategory=${encodeURIComponent(category)}` +
			// 	`&PropertyType_Parent=${encodeURIComponent(typeParent)}` +
			// 	`&PropertyType=${encodeURIComponent(type)}`;

		const url = `@Url.Action("Properties", "Home")`;
		debugger;
		fetch(url, {
			method: 'GET',
			headers: {
				'FirstName': $('#firstName').val() || '',
				'LastName': $('#lastName').val() || '',
				'Email': $('#email').val() || '',
				'ContactNo': $('#ContactNo').val() || '',
				'Location': location,
				'PropertyCategory': category,
				//'PropertyType_Parent': typeParent,
				'PropertyType': type,
				'PropertySubType': subtype
			}
		})
		.then(async response =>
		{

			if (!response.ok) {
				let errorBody = null;

				try {
					errorBody = await response.json(); // 👈 read body
					showToast(errorBody.Message, 'danger', 5000);
					return; // stop here
				} catch {
					// response is not JSON
				}

			}

			// ✅ Response is OK → redirect
			//window.location.href = url;
			else return response.text(); // HTML
		})
		.then(html => {

			document.open();
			document.write(html);
			document.close();
		})
		.catch(err => {
			showToast('Opps!... Something went wrong', 'danger', 5000);
		});



		}

		//let childChoices;

		// const childSelect = document.getElementById('choices-PropertyType');
		// const originalOptions = Array.from(childSelect.options).map(o => o.cloneNode(true) );

		// document.getElementById('choices-PropertyType_Parent').addEventListener('change', function () {
		//   const selectedParent = this.value;

		//   var filterd = originalOptions.filter(o => o.dataset.parent === selectedParent).map(o => ({ value: o.value, label: o.text, }));

		// 	const choices = childSelect._choicesInstance;

		// 	choices.clearChoices();
		// 	choices.removeActiveItems();
		// 	choices.setChoices(filterd, 'value', 'label', true );

		// });


		$(document).on('click', '#pills-tab .nav-link', function (e) {
			e.preventDefault();

			const childSelect = document.getElementById('choices-PropertyType');
			const choices = childSelect._choicesInstance;

			choices.clearChoices();
			choices.removeActiveItems();

			let categoryId = $(e.target).attr('id');

			$.ajax({
				type: 'GET',
				url: '@Url.Action("PropertyCategoryType_Get", "Home")?CategoryId='+categoryId,
				data: null,
				cache: false,
				contentType: false,
				processData: false,
				dataType: "json",
				success: function (response) {
					var filterd = response.map(o => ({ value: o.TypeId, label: o.TypeName, }));

					choices.setChoices(filterd, 'value', 'label', true );

					choices.setChoiceByValue('ipsum');
				},
				error: function (xhr) {
					console.error("Error:", xhr.responseText);
				}
			});
		});

	</script>
}